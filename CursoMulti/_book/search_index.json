[
["ElegirModelo.html", "Capítulo 2 Selección de modelos 2.1 Paquetes necesarios para este capítulo 2.2 Introducción 2.3 ¿Como decidimos que modelo elegimos para explicar mejor un fenomeno? 2.4 Promediar modelos 2.5 Discusión artículo", " Capítulo 2 Selección de modelos 2.1 Paquetes necesarios para este capítulo Para este capitulo necesitas tener instalado los paquetes tidyverse (Wickham 2019), broom (Robinson and Hayes 2019) y MuMIn (Bartoń 2019) 2.2 Introducción La inferencia Multimodelo (Anderson and Burnham 2004) es un campo teórico de la estadística que nos perminte tomar decisiones equilibrando el poder predictivo y explicativo de multiples modelos en competencia, y nos da un marco de acción para seleccionar entre distintos modelos, dentro de esto, seleccionar el o los modelos más parsimoniosos entre varios en competencia, no el que predice más 2.2.0.1 Que es lo que no nos permite la inferencia multimodelo Si bien la Inferencia Multimodelo es una herramienta muy poderosa, hay varios problemas previos que no puede arreglar, entre ellos está un estudio mal diseñado y una pobre selección de variables a explicar un problema. Por otro lado, es importante recordar que la Inferencia Multimodelo no es una receta, hay mucho de criterio y desiciones que tomar en base a nuestro conocimiento del sistema a modelar. 2.2.1 Que necesitamos para realizar inferencia multimodelo Antes de intentar seleccionar entre modelos, hay varios pasos a seguir, lo primero es generar un buen diseño de muestreo o diseño experimental para nuestra base de datos y pregunta, luego debemos generar las hipótesis de forma muy cuidadosa y detallada, y finalmente (y quizás lo más importante para este curso), la selección adecuada de variables para distinguir entre hipótesis. 2.3 ¿Como decidimos que modelo elegimos para explicar mejor un fenomeno? Partamos con una base de datos, utilizaremos la base de datos de kaggle de expectativa de vida que encontramos en el el siguiente link (Rajarshi 2018), y que he modificado, aquí esta el código para bajar la versión simplificada y modificada por mi: URL &lt;- download.file(&quot;https://github.com/derek-corcoran-barrios/derek-corcoran-barrios.github.io/raw/master/CursoMulti/LifeExpect.rds&quot;, &quot;LifeExpect.rds&quot;) Life_Expect &lt;- readRDS(&quot;LifeExpect.rds&quot;) DT::datatable(Life_Expect, caption = &quot;Expectativa de vida en distintos países en distintos años&quot;, extensions = c(&quot;FixedColumns&quot;, &quot;FixedHeader&quot;), options = list(scrollX = TRUE, paging = FALSE, fixedHeader = TRUE)) 2.3.1 Paquete MuMIn Multi Moldel Inference data(&quot;mtcars&quot;) fit1 &lt;- glm(mpg ~ carb + cyl, data = mtcars) fit2 &lt;- glm(mpg ~ cyl + wt, data = mtcars) fit3 &lt;- glm(mpg ~ am + qsec + wt, data = mtcars) fit4 &lt;- glm(mpg ~ carb + cyl + wt, data = mtcars) fit5 &lt;- glm(mpg ~ am + carb + cyl + qsec + wt, data = mtcars) fit6 &lt;- glm(mpg ~ am + carb + cyl + hp + qsec, data = mtcars) models &lt;- list(fit1, fit2, fit3, fit4, fit5, fit6) 2.3.2 Paquete MuMIn (model.sel) Select &lt;- model.sel(models) (Intercept) carb cyl wt am qsec hp df logLik AICc delta weight 9.62 NA NA -3.92 2.94 1.23 NA 5 -72.06 156.43 0.00 0.46 39.69 NA -1.51 -3.19 NA NA NA 4 -74.01 157.49 1.06 0.27 39.60 -0.49 -1.29 -3.16 NA NA NA 5 -72.81 157.93 1.50 0.22 20.04 -0.52 -0.46 -3.05 2.94 0.73 NA 7 -71.03 160.73 4.30 0.05 33.97 -0.80 -1.27 NA 4.19 -0.13 -0.02 7 -74.85 168.36 11.93 0.00 37.81 -0.53 -2.63 NA NA NA NA 4 -80.79 171.06 14.64 0.00 ¿Que modelos seleccionamos? 2.3.3 ¿Pesos de Akaike? Suman uno A mayor peso, mejor modelo Dependen del número de modelos Selected &lt;- subset(Select, delta &lt;= 2) (Intercept) carb cyl wt am qsec hp df logLik AICc delta weight 9.62 NA NA -3.92 2.94 1.23 NA 5 -72.06 156.43 0.00 0.49 39.69 NA -1.51 -3.19 NA NA NA 4 -74.01 157.49 1.06 0.29 39.60 -0.49 -1.29 -3.16 NA NA NA 5 -72.81 157.93 1.50 0.23 (Intercept) carb cyl wt am qsec hp df logLik AICc delta weight 9.62 NA NA -3.92 2.94 1.23 NA 5 -72.06 156.43 0.00 0.63 39.69 NA -1.51 -3.19 NA NA NA 4 -74.01 157.49 1.06 0.37 2.3.4 ¿Hemos seleccionado 3 modelos ahora que? Seleccionar el mejor modelo BestModel &lt;- get.models(Select, 1)[[1]] broom::glance(BestModel) null.deviance df.null logLik AIC BIC deviance df.residual 1126.05 31 -72.06 154.12 161.45 169.29 28 2.3.5 Mejor modelo broom::tidy(BestModel) term estimate std.error statistic p.value (Intercept) 9.62 6.96 1.38 0.18 am 2.94 1.41 2.08 0.05 qsec 1.23 0.29 4.25 0.00 wt -3.92 0.71 -5.51 0.00 ¿p no es significativo? ¡¡¡¡No importa!!!! 2.4 Promediar modelos 2.4.1 Promediar modelos usando MuMIn Trabajemos con el numero de cilindros S &lt;- as.data.frame(Selected) S &lt;- as.data.frame(Selected) %&gt;% select(cyl, weight) cyl weight 3 NA 0.4854123 2 -1.51 0.2850763 4 -1.29 0.2295115 Dos métodos full y subset 2.4.2 Metodo full \\[\\hat{\\theta} = \\sum_{i=1}^R w_i \\times \\theta_i\\] S_full &lt;- S S_full$cyl &lt;- ifelse(is.na(S_full$cyl), 0, S_full$cyl) S_full &lt;- S_full %&gt;% mutate(Theta_i = cyl * weight) cyl weight Theta_i 0.00 0.4854123 0.0000000 -1.51 0.2850763 -0.4298366 -1.29 0.2295115 -0.2960210 Cyl_hat &lt;- sum(S_full$Theta_i) ## [1] -0.7258576 2.4.3 Método subset \\[\\hat{\\theta} = \\frac{\\sum_{i=1}^Rw_i \\times \\theta_i}{\\sum_{i=1}^Rw_i}\\] S_sub &lt;- S %&gt;% filter(!is.na(cyl)) S_sub &lt;- S_sub %&gt;% mutate(Theta_i = cyl * weight) cyl weight Theta_i -1.51 0.2850763 -0.4298366 -1.29 0.2295115 -0.2960210 Cyl_hat &lt;- sum(S_sub$Theta_i)/sum(S_sub$weight) ## [1] -1.410561 2.4.4 MuMIn AverageModel &lt;- model.avg(Select, subset = delta &lt; 2, fit = T) AverageModel$coefficients (Intercept) am qsec wt cyl carb full 25.07 1.43 0.60 -3.54 -0.73 -0.11 subset 25.07 2.94 1.23 -3.54 -1.41 -0.49 # AverageModel$importance 2.4.5 Comparemos modelos 2.4.6 Comparemos modelos (cont.) 2.5 Discusión artículo 2.5.1 GPA y multiolinearidad 2.5.2 GPA y multiolinearidad (cont) 2.5.3 Todos vs Delta 2 References "]
]
