<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Práctico 1 Exploración de datos y tu primer ANOVA | Practicos de Bioestadística 2</title>
  <meta name="description" content="Este libro es una compañia al curso BIO4022, análisis y manipulación de datos en R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Práctico 1 Exploración de datos y tu primer ANOVA | Practicos de Bioestadística 2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este libro es una compañia al curso BIO4022, análisis y manipulación de datos en R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Práctico 1 Exploración de datos y tu primer ANOVA | Practicos de Bioestadística 2" />
  
  <meta name="twitter:description" content="Este libro es una compañia al curso BIO4022, análisis y manipulación de datos en R" />
  

<meta name="author" content="Derek Corcoran">


<meta name="date" content="2019-06-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="Supuestos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Practicos de Biestadistica 2 </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Requerimientos</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#antes-de-comenzar"><i class="fa fa-check"></i><b>0.1</b> Antes de comenzar</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#descripcion-del-practico"><i class="fa fa-check"></i><b>0.2</b> Descripción del práctico</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#objetivos-del-practico"><i class="fa fa-check"></i><b>0.3</b> Objetivos del práctico</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#contenidos"><i class="fa fa-check"></i><b>0.4</b> Contenidos</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#metodologia"><i class="fa fa-check"></i><b>0.5</b> Metodología</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#evaluacion"><i class="fa fa-check"></i><b>0.6</b> Evaluación</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#presentacion-de-introduccion"><i class="fa fa-check"></i><b>0.7</b> Presentación de introducción</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Explorando.html"><a href="Explorando.html"><i class="fa fa-check"></i><b>1</b> Exploración de datos y tu primer ANOVA</a><ul>
<li class="chapter" data-level="1.1" data-path="Explorando.html"><a href="Explorando.html#paquetes-necesarios-para-este-practico"><i class="fa fa-check"></i><b>1.1</b> Paquetes necesarios para este práctico</a></li>
<li class="chapter" data-level="1.2" data-path="Explorando.html"><a href="Explorando.html#actividad-1-educacion-en-chile"><i class="fa fa-check"></i><b>1.2</b> Actividad 1 Educación en Chile</a><ul>
<li class="chapter" data-level="1.2.1" data-path="Explorando.html"><a href="Explorando.html#tablas-resumen-de-los-datos"><i class="fa fa-check"></i><b>1.2.1</b> Tablas resumen de los datos:</a></li>
<li class="chapter" data-level="1.2.2" data-path="Explorando.html"><a href="Explorando.html#visualizacion-de-datos-con-ggplot2-tidyverse"><i class="fa fa-check"></i><b>1.2.2</b> Visualización de datos con ggplot2 (tidyverse)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Explorando.html"><a href="Explorando.html#actividad-2-captacion-de-co2-en-plantas"><i class="fa fa-check"></i><b>1.3</b> Actividad 2 Captación de CO2 en plantas</a></li>
<li class="chapter" data-level="1.4" data-path="Explorando.html"><a href="Explorando.html#actividad-3-mi-primer-anova"><i class="fa fa-check"></i><b>1.4</b> Actividad 3 Mi primer ANOVA</a><ul>
<li class="chapter" data-level="1.4.1" data-path="Explorando.html"><a href="Explorando.html#antes-de-empezar-a-entender-el-anova"><i class="fa fa-check"></i><b>1.4.1</b> antes de empezar a entender el ANOVA</a></li>
<li class="chapter" data-level="1.4.2" data-path="Explorando.html"><a href="Explorando.html#como-hacer-un-anova-en-r"><i class="fa fa-check"></i><b>1.4.2</b> Como hacer un ANOVA en R</a></li>
<li class="chapter" data-level="1.4.3" data-path="Explorando.html"><a href="Explorando.html#ejercicio"><i class="fa fa-check"></i><b>1.4.3</b> Ejercicio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Supuestos.html"><a href="Supuestos.html"><i class="fa fa-check"></i><b>2</b> Supuestos de ANOVA y mínimos cuadrados</a><ul>
<li class="chapter" data-level="2.1" data-path="Supuestos.html"><a href="Supuestos.html#paquetes-necesarios-para-este-practico-1"><i class="fa fa-check"></i><b>2.1</b> Paquetes necesarios para este práctico</a></li>
<li class="chapter" data-level="2.2" data-path="Supuestos.html"><a href="Supuestos.html#objetivos-de-este-practico"><i class="fa fa-check"></i><b>2.2</b> Objetivos de este práctico</a></li>
<li class="chapter" data-level="2.3" data-path="Supuestos.html"><a href="Supuestos.html#actividad-1-sueno-en-mamiferos"><i class="fa fa-check"></i><b>2.3</b> Actividad 1 Sueño en mamíferos</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Supuestos.html"><a href="Supuestos.html#homogeneidad-de-varianza"><i class="fa fa-check"></i><b>2.3.1</b> Homogeneidad de varianza</a></li>
<li class="chapter" data-level="2.3.2" data-path="Supuestos.html"><a href="Supuestos.html#normalidad-de-los-residuales"><i class="fa fa-check"></i><b>2.3.2</b> Normalidad de los residuales</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Supuestos.html"><a href="Supuestos.html#actividad-2-suma-de-cuadrados"><i class="fa fa-check"></i><b>2.4</b> Actividad 2 Suma de cuadrados</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Supuestos.html"><a href="Supuestos.html#que-es-el-error-por-que-al-cuadrado"><i class="fa fa-check"></i><b>2.4.1</b> ¿Que es el error? ¿Por qué al cuadrado??</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Supuestos.html"><a href="Supuestos.html#referencias"><i class="fa fa-check"></i><b>2.5</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Poder.html"><a href="Poder.html"><i class="fa fa-check"></i><b>3</b> Análisis de poder</a><ul>
<li class="chapter" data-level="3.1" data-path="Poder.html"><a href="Poder.html#obejtivos-del-practico"><i class="fa fa-check"></i><b>3.1</b> Obejtivos del práctico</a></li>
<li class="chapter" data-level="3.2" data-path="Poder.html"><a href="Poder.html#matriz-de-confusion"><i class="fa fa-check"></i><b>3.2</b> Matriz de confusión</a><ul>
<li class="chapter" data-level="3.2.1" data-path="Poder.html"><a href="Poder.html#poder-y-matriz-de-confusion"><i class="fa fa-check"></i><b>3.2.1</b> Poder y matriz de confusión</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Poder.html"><a href="Poder.html#calculo-de-poder-en-r"><i class="fa fa-check"></i><b>3.3</b> Calculo de poder en R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="t-student.html"><a href="t-student.html"><i class="fa fa-check"></i><b>4</b> Prueba t de Student</a><ul>
<li class="chapter" data-level="4.0.1" data-path="t-student.html"><a href="t-student.html#pruebas-de-una-muestra"><i class="fa fa-check"></i><b>4.0.1</b> Pruebas de una muestra</a></li>
<li class="chapter" data-level="4.0.2" data-path="t-student.html"><a href="t-student.html#pruebas-de-dos-muestras"><i class="fa fa-check"></i><b>4.0.2</b> Pruebas de dos muestras</a></li>
<li class="chapter" data-level="4.1" data-path="t-student.html"><a href="t-student.html#supuestos-de-la-prueba-de-t-y-alternativas"><i class="fa fa-check"></i><b>4.1</b> Supuestos de la prueba de t y alternativas</a><ul>
<li class="chapter" data-level="4.1.1" data-path="t-student.html"><a href="t-student.html#prueba-de-una-muestra"><i class="fa fa-check"></i><b>4.1.1</b> Prueba de una muestra</a></li>
<li class="chapter" data-level="4.1.2" data-path="t-student.html"><a href="t-student.html#prueba-de-dos-muestras"><i class="fa fa-check"></i><b>4.1.2</b> Prueba de dos muestras</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="t-student.html"><a href="t-student.html#bibliografia"><i class="fa fa-check"></i><b>4.2</b> Bibliografía</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="posthoc.html"><a href="posthoc.html"><i class="fa fa-check"></i><b>5</b> Comparaciones posthoc y diseños anidados</a><ul>
<li class="chapter" data-level="5.1" data-path="posthoc.html"><a href="posthoc.html#comparaciones-posthoc"><i class="fa fa-check"></i><b>5.1</b> Comparaciones posthoc</a><ul>
<li class="chapter" data-level="5.1.1" data-path="posthoc.html"><a href="posthoc.html#prueba-honesta-de-diferencias-significativas-de-tukey"><i class="fa fa-check"></i><b>5.1.1</b> Prueba honesta de diferencias significativas de Tukey</a></li>
<li class="chapter" data-level="5.1.2" data-path="posthoc.html"><a href="posthoc.html#ajustes-de-valores-de-p-para-comparaciones-multiples"><i class="fa fa-check"></i><b>5.1.2</b> Ajustes de valores de p para comparaciones multiples</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="posthoc.html"><a href="posthoc.html#disenos-anidados"><i class="fa fa-check"></i><b>5.2</b> Diseños anidados</a></li>
<li class="chapter" data-level="5.3" data-path="posthoc.html"><a href="posthoc.html#tarea-1"><i class="fa fa-check"></i><b>5.3</b> Tarea 1</a></li>
<li class="chapter" data-level="5.4" data-path="posthoc.html"><a href="posthoc.html#referencias-1"><i class="fa fa-check"></i><b>5.4</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Formula.html"><a href="Formula.html"><i class="fa fa-check"></i><b>6</b> Como formular tu ANOVA</a><ul>
<li class="chapter" data-level="6.1" data-path="Formula.html"><a href="Formula.html#anovas"><i class="fa fa-check"></i><b>6.1</b> ANOVA(s)</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Formula.html"><a href="Formula.html#anova-simple"><i class="fa fa-check"></i><b>6.1.1</b> ANOVA simple</a></li>
<li class="chapter" data-level="6.1.2" data-path="Formula.html"><a href="Formula.html#anova-factorial"><i class="fa fa-check"></i><b>6.1.2</b> ANOVA factorial</a></li>
<li class="chapter" data-level="6.1.3" data-path="Formula.html"><a href="Formula.html#anova-anidado-o-jerarquico"><i class="fa fa-check"></i><b>6.1.3</b> ANOVA anidado o jerarquico</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Formula.html"><a href="Formula.html#variables-fijas-vs-aleatoreas"><i class="fa fa-check"></i><b>6.2</b> Variables fijas vs aleatoreas</a><ul>
<li class="chapter" data-level="6.2.1" data-path="Formula.html"><a href="Formula.html#mas-casos-y-resumen"><i class="fa fa-check"></i><b>6.2.1</b> Más casos y resumen</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="Formula.html"><a href="Formula.html#referencias-2"><i class="fa fa-check"></i><b>6.3</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TipoError.html"><a href="TipoError.html"><i class="fa fa-check"></i><b>7</b> Tipos de errores cuadrados</a><ul>
<li class="chapter" data-level="7.1" data-path="TipoError.html"><a href="TipoError.html#objetivos-del-practico-1"><i class="fa fa-check"></i><b>7.1</b> Objetivos del práctico</a></li>
<li class="chapter" data-level="7.2" data-path="TipoError.html"><a href="TipoError.html#cuadrados-medios-esperados"><i class="fa fa-check"></i><b>7.2</b> Cuadrados medios esperados</a><ul>
<li class="chapter" data-level="7.2.1" data-path="TipoError.html"><a href="TipoError.html#cuadrados-medios-de-tipo-i"><i class="fa fa-check"></i><b>7.2.1</b> Cuadrados medios de tipo I</a></li>
<li class="chapter" data-level="7.2.2" data-path="TipoError.html"><a href="TipoError.html#cuadrados-medios-de-tipo-ii"><i class="fa fa-check"></i><b>7.2.2</b> Cuadrados medios de tipo II</a></li>
<li class="chapter" data-level="7.2.3" data-path="TipoError.html"><a href="TipoError.html#paquete-emsaov"><i class="fa fa-check"></i><b>7.2.3</b> Paquete EMSaov</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Bloque.html"><a href="Bloque.html"><i class="fa fa-check"></i><b>8</b> Diseños en bloque y split-plot</a><ul>
<li class="chapter" data-level="8.1" data-path="Bloque.html"><a href="Bloque.html#objetivos-del-practico-2"><i class="fa fa-check"></i><b>8.1</b> Objetivos del práctico</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="repetidas.html"><a href="repetidas.html"><i class="fa fa-check"></i><b>9</b> Medidas repetidas</a><ul>
<li class="chapter" data-level="9.0.1" data-path="repetidas.html"><a href="repetidas.html#version-1"><i class="fa fa-check"></i><b>9.0.1</b> Version 1</a></li>
<li class="chapter" data-level="9.0.2" data-path="repetidas.html"><a href="repetidas.html#version-2"><i class="fa fa-check"></i><b>9.0.2</b> Version 2</a></li>
<li class="chapter" data-level="9.1" data-path="repetidas.html"><a href="repetidas.html#tarea-2"><i class="fa fa-check"></i><b>9.1</b> Tarea 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>10</b> Máxima verosimilitud y Modelos lineales</a></li>
<li class="chapter" data-level="11" data-path="GLMs.html"><a href="GLMs.html"><i class="fa fa-check"></i><b>11</b> Modelos Lineales Generalizados</a></li>
<li class="chapter" data-level="12" data-path="Refs.html"><a href="Refs.html"><i class="fa fa-check"></i><b>12</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practicos de Bioestadística 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Explorando" class="section level1">
<h1><span class="header-section-number">Práctico 1</span> Exploración de datos y tu primer ANOVA</h1>
<div id="paquetes-necesarios-para-este-practico" class="section level2">
<h2><span class="header-section-number">1.1</span> Paquetes necesarios para este práctico</h2>
<p>Para este capitulo necesitas tener instalado el paquete tidyverse. Esta clase del curso puede también ser seguida en este <a href="http://www.derek-corcoran-barrios.com/AyudantiaStatsPres/Clase2/Clase2.html">link</a>. El video de la clase se encuentra disponible en este <a href="https://youtu.be/DM2U19a1y4s">link</a>.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DM2U19a1y4s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="actividad-1-educacion-en-chile" class="section level2">
<h2><span class="header-section-number">1.2</span> Actividad 1 Educación en Chile</h2>
<p>En esta actividad exploraremos los resultados de la PSU en Chile para el año 2017. Pueden encontrar la base de datos original en <a href="https://es.datachile.io/geo/chile#education">Data Chile</a>.</p>
<p>Trataremos de determinar, usando el puntaje de la PSU como medida, si existen brechas en la educación chilena por tipo de institución. Para ello, primero trabajaremos realizando análisis exploratorios en base a gráficos y tablas resumen usando funciones del paquete <em>tidyverse</em> <span class="citation">(Wickham <a href="#ref-WickhamTidy2017">2017</a>)</span> en R.</p>
<p>La base de datos <em>EducacionChile.csv</em> se encuentra disponible en webcursos o en <a href="https://es.datachile.io/geo/chile#education" class="uri">https://es.datachile.io/geo/chile#education</a>.</p>
<div id="tablas-resumen-de-los-datos" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Tablas resumen de los datos:</h3>
<p>Lo primero que deben hacer es generar una tabla resumen usando el <em>tidyverse</em> usando las funciones <em>group_by</em> para agrupar por variables y <em>summarize</em> para resumir los datos, dentro de summarize podemos usar variables como:</p>
<ul>
<li><strong>mean()</strong> promedio</li>
<li><strong>sd()</strong> desviación estándar</li>
<li><strong>n()</strong> número de muestras</li>
</ul>
<p>a modo de ejemplo vemos la tabla <a href="Explorando.html#tab:MediaIris">1.1</a> mostrando la media y número de muestras con la base de datos iris:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)
Table &lt;-<span class="st"> </span><span class="kw">group_by</span>(iris, Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Promedio =</span> <span class="kw">mean</span>(Petal.Length), <span class="dt">N =</span> <span class="kw">n</span>())</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(Table)</code></pre></div>
<table>
<caption>
<span id="tab:MediaIris">Tabla 1.1: </span>Resumen con la media y número de muestras del largo de pétalo de las flores de tres especies del género Iris
</caption>
<thead>
<tr>
<th style="text-align:left;">
Species
</th>
<th style="text-align:right;">
Promedio
</th>
<th style="text-align:right;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
1.462
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
versicolor
</td>
<td style="text-align:right;">
4.260
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
5.552
</td>
<td style="text-align:right;">
50
</td>
</tr>
</tbody>
</table>
<p>Basado en el resumen ¿Qué podemos decir de estos datos de educación en Chile?</p>
</div>
<div id="visualizacion-de-datos-con-ggplot2-tidyverse" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Visualización de datos con ggplot2 (tidyverse)</h3>
<p>El paquete <em>ggplot2</em> <span class="citation">(Wickham <a href="#ref-WickhamGG2016">2016</a>)</span> es una poderosa herramienta para graficar datos. Si desean ahondar en el uso de este paquete, pueden ver el siguiente link <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/" class="uri">http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/</a>. En este caso, aprenderemos a graficar <em>boxplots</em> y <em>jitterplots</em>, dos opciones para visualizar una variable categórica versus una cuantitativa.</p>
<div id="uso-del-ggplot2" class="section level4">
<h4><span class="header-section-number">1.2.2.1</span> Uso del ggplot2</h4>
<p>Su función principal es <em>ggplot</em>, luego de cada función usaremos el símbolo <strong>+</strong> como usábamos el pipeline (%&gt;%).</p>
<p>Primero usamos la función ggplot para determinar la base de datos y variables, acá las variables siempre van dentro de la función aes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(MiBaseDeDatos, <span class="kw">aes</span>(<span class="dt">x =</span> VariableX, <span class="dt">y =</span> VariableY)) </code></pre></div>
<p>Luego agregamos el tipo de gráfico que queremos para nuestra figura usando el <strong>+</strong> como pipeline</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(MiBaseDeDatos, <span class="kw">aes</span>(<span class="dt">x =</span> VariableX, <span class="dt">y =</span> VariableY)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
</div>
<div id="ejemplo-usando-la-base-de-datos-iris" class="section level4">
<h4><span class="header-section-number">1.2.2.2</span> Ejemplo usando la base de datos iris</h4>
<div id="boxplot" class="section level5">
<h5><span class="header-section-number">1.2.2.2.1</span> Boxplot</h5>
<p>El siguiente código muestra como graficar un boxplot para la base de datos iris, la cual esta en R. En este caso graficaremos el largo del pétalo para cada especie (Figura <a href="Explorando.html#fig:BoxplotIris">1.1</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Petal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<div class="figure"><span id="fig:BoxplotIris"></span>
<img src="AyduantiaStats_files/figure-html/BoxplotIris-1.png" alt="Box plot del largo de petalo de tres especies del género Iris" width="672" />
<p class="caption">
Figura 1.1: Box plot del largo de petalo de tres especies del género Iris
</p>
</div>
<p>En los Box Plots tenemos 4 visualizaciones:</p>
<ul>
<li>Mediana (linea gruesa)</li>
<li>Caja (Cuantiles 25% y 75%)</li>
<li>Bigotes (intervalo de confianza del 95%)</li>
<li>Puntos Outlayers</li>
</ul>
<p>Realice un boxplot de los datos de la educación de Chile, ¿Qué nos dice esto de los datos?</p>
</div>
<div id="jitter-plot" class="section level5">
<h5><span class="header-section-number">1.2.2.2.2</span> Jitter plot</h5>
<p>El jitter plot suma un punto por cada observación, lo cual nos permite entender un poco más la naturaleza de los datos. En general se le agrega a un box plot para tener mayor claridad en los datos (Figura <a href="Explorando.html#fig:JitterIris">1.2</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Petal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species))</code></pre></div>
<div class="figure"><span id="fig:JitterIris"></span>
<img src="AyduantiaStats_files/figure-html/JitterIris-1.png" alt="Box plot y jitter plot juntos para el largo de petalo de tres especies del género Iris" width="672" />
<p class="caption">
Figura 1.2: Box plot y jitter plot juntos para el largo de petalo de tres especies del género Iris
</p>
</div>
</div>
</div>
</div>
</div>
<div id="actividad-2-captacion-de-co2-en-plantas" class="section level2">
<h2><span class="header-section-number">1.3</span> Actividad 2 Captación de CO2 en plantas</h2>
<p>Utilizaremos base de datos <span class="math inline">\(CO_2\)</span> <span class="citation">(Potvin, Lechowicz, and Tardif <a href="#ref-potvin1990statistical">1990</a>)</span> enviada al curso. Esta base de datos, también presente en R, tiene las siguientes variables</p>
<ul>
<li><strong>Plant</strong>: Identidad de cada planta</li>
<li><strong>Type</strong>: Variedad de la planta (subespecie Quebec o Mississippi)</li>
<li><strong>Treatment</strong>: Tratamiento de la planta, algunas fueron enfriadas la noche anterior (Chilled)</li>
<li><strong>conc</strong>: Concentración ambiental de <span class="math inline">\(CO_2\)</span></li>
<li><strong>Uptake</strong>: Captación de <span class="math inline">\(CO_2\)</span> para cada planta en cada día</li>
</ul>
<p>¿Hay diferencias entre la captación de <span class="math inline">\(CO_2\)</span> en plantas tratadas y no tratadas?</p>
<ul>
<li>Genere tablas resumenes que le permitan explorar esta pregunta
<ul>
<li>¿Existen variables que puedan confundir el resultado? ¿como trataría los datos para lidiar con esto?</li>
</ul></li>
<li>Genere gráficos exploratorios para contestar esta pregunta</li>
</ul>
</div>
<div id="actividad-3-mi-primer-anova" class="section level2">
<h2><span class="header-section-number">1.4</span> Actividad 3 Mi primer ANOVA</h2>
<div id="antes-de-empezar-a-entender-el-anova" class="section level3">
<h3><span class="header-section-number">1.4.1</span> antes de empezar a entender el ANOVA</h3>
<p>El ANOVA compara medias entre grupos, lo principal es la comparación entre los cuadrados de los residuales intergrupos, y los residuales intragrupos, los primeros son los cuadrados de la diferencia entre las medias de todas las observaciones (<span class="math inline">\(\tilde{x}_t\)</span>) y las medias de cada grupo <span class="math inline">\(\tilde{x}_g\)</span> al cuadrado multiplicado por el número de observaciones totales (ver ecuación <a href="Explorando.html#eq:intergrups">(1.1)</a>), cambia las medias del simlador de anova a continuacion y selecciona los errores intergrupos y ve como cambian.</p>
<span class="math display" id="eq:intergrups">\[\begin{equation} 
  \textrm{Errores_inter_factor} = n \times \sum{(\tilde{x}_t - \tilde{x}_g)^2}
  \tag{1.1}
\end{equation}\]</span>
<p>los residuales intra grupos son la diferencia entre cada observación <span class="math inline">\(x_{i,g}\)</span> del grupo <span class="math inline">\(g\)</span> y las medias del grupo respectivo (ver ecuación <a href="Explorando.html#eq:intragrups">(1.2)</a>), cambia las medias del simlador de anova a continuacion y selecciona los errores intragrupos y ve como cambian</p>
<span class="math display" id="eq:intragrups">\[\begin{equation} 
  \textrm{Errores_intra_factor} = \sum{(\tilde{x}_g - x_{i,g})^2}
  \tag{1.2}
\end{equation}\]</span>
<div id="simulador-de-anova" class="section level4">
<h4><span class="header-section-number">1.4.1.1</span> Simulador de ANOVA</h4>
<iframe src="http://admin.derek-corcoran-barrios.com/shiny/rstudio/sample-apps/Shiny2/?showcase=0" width="672" height="1500px">
</iframe>
</div>
</div>
<div id="como-hacer-un-anova-en-r" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Como hacer un ANOVA en R</h3>
<p>En <em>R</em> todos los modelos tienen la siguiente estructura <strong>Funcion(y ~ x1 + x2 + … + xn, data = MisDatos)</strong>, donde la <strong>Funcion</strong> dice el modelo que queremos realizar (por ejemplo ANOVA, regresión lineal, modelos mixtos, etc.), <strong>y</strong> es la variable que queremos explicar, <strong>x1</strong> a <strong>xn</strong> son las variables explicativas, <strong>~</strong> es un símbolo que debe ser leído como explicado por y finalmente <strong>data</strong> es la base de datos que queremos utilizar, en un ANOVA (análisis de varianza), la función en cuestión es aov.</p>
<p>En el siguiente código vemos si el largo del pétalo de las flores del género <em>Iris</em>, pueden ser explicados por la especie a la que estas plantas pertenecen, por lo que generamos un modelo llamado <em>Primer.Anova</em> con la función <strong>aov</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Primer.Anova &lt;-<span class="st"> </span><span class="kw">aov</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> iris)</code></pre></div>
<p>Para acceder a la tabla de resultados utilizamos la función <strong>summary</strong></p>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Species       2  437.1  218.55    1180 &lt;2e-16 ***
## Residuals   147   27.2    0.19                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Si establecemos el valor de alfa en 0.05 y al ver en la tabla que el valor de p es menor a alfa, rechazamos la hipótesis nula de que las medias son iguales, y decidimos que la media del largo de pétalo es distinta entre las especies.</p>
</div>
<div id="ejercicio" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Ejercicio</h3>
<p>Determine si para la base de datos <strong>CO2</strong> la captación de <span class="math inline">\(CO_2\)</span> es distinto entre plantas con tratamiento de enfriamiento y sin enfriamiento.</p>

</div>
</div>
</div>
<h3> Referencias</h3>
<div id="refs" class="references">
<div id="ref-WickhamTidy2017">
<p>Wickham, Hadley. 2017. <em>Tidyverse: Easily Install and Load the ’Tidyverse’</em>. <a href="https://CRAN.R-project.org/package=tidyverse" class="uri">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="ref-WickhamGG2016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a>.</p>
</div>
<div id="ref-potvin1990statistical">
<p>Potvin, Catherine, Martin J Lechowicz, and Serge Tardif. 1990. “The Statistical Analysis of Ecophysiological Response Curves Obtained from Experiments Involving Repeated Measures.” <em>Ecology</em> 71 (4). Wiley Online Library: 1389–1400.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Supuestos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["AyduantiaStats.pdf", "AyduantiaStats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
